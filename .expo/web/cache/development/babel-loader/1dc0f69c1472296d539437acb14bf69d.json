{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/Users/devonhubert/languages/javascript/react_native/PayCheck/screens/MainPage.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport firebase from 'firebase';\nimport Modal from 'react-native-modal';\nimport InterfaceFrame from \"../components/InterfaceFrame\";\nimport GoalAdder from \"../components/GoalAdder\";\nimport Spacer from \"../components/Spacer\";\nimport GoalWindow from \"../components/GoalWindow\";\n\nvar styles = require(\"../Styles\");\n\nvar MainPage = function (_Component) {\n  _inherits(MainPage, _Component);\n\n  var _super = _createSuper(MainPage);\n\n  function MainPage() {\n    var _this;\n\n    _classCallCheck(this, MainPage);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      goals: [],\n      keyIndex: 0,\n      moneyEarned: 0,\n      isGoalAdderVisible: false,\n      isGoogleInfoVisible: false,\n      isMoneyLoggerVisible: false,\n      userName: 'No Name',\n      userEmail: 'No Email',\n      profilePicUrl: '../assets/newLogo.png'\n    };\n\n    _this.pullMoneyEarned = function (user) {\n      console.log(\"Pull money earned called\");\n\n      if (user) {\n        firebase.database().ref('/users/' + user.uid + '/user_app_data/total_earned/').on('value', function (snapShot) {\n          var total_earned = snapShot.val();\n          console.log(\"Total earned is: \" + total_earned);\n\n          _this.setState({\n            moneyEarned: total_earned\n          });\n        });\n      }\n    };\n\n    _this.writeTotalMoneyEarned = function (totalEarned) {\n      var user = firebase.auth().currentUser;\n\n      if (user) {\n        firebase.database().ref('users/' + user.uid + '/user_app_data/').update({\n          total_earned: totalEarned\n        });\n\n        _this.pullMoneyEarned(user);\n      }\n    };\n\n    _this.pullGoals = function (user) {\n      console.log(\"Pull goals called\");\n\n      if (user) {\n        firebase.database().ref('/users/' + user.uid + '/user_app_data/goals/').on('value', function (snapShot) {\n          var goals = snapShot.val() ? snapShot.val() : [];\n          console.log(\"Current goal object: \" + goals);\n          console.log(\"Length of goals: \" + Object.keys(goals).length);\n\n          _this.setState({\n            goals: goals\n          });\n        });\n      }\n    };\n\n    _this.writeNewGoal = function (goalName, moneyNeeded) {\n      var user = firebase.auth().currentUser;\n\n      if (user) {\n        firebase.database().ref('users/' + user.uid + '/user_app_data/goals/' + _this.state.keyIndex).update({\n          name: goalName,\n          needed: moneyNeeded,\n          earned: 0.0,\n          key: _this.state.keyIndex\n        });\n\n        _this.pullGoals(user);\n\n        firebase.database().ref('users/' + user.uid + '/user_app_data/').update({\n          key_index: _this.state.keyIndex + 1\n        });\n\n        _this.pullKeyIndex(user);\n      }\n    };\n\n    _this.pullKeyIndex = function (user) {\n      console.log(\"Pull key index called\");\n\n      if (user) {\n        firebase.database().ref('/users/' + user.uid + '/user_app_data/key_index').on('value', function (snapShot) {\n          var key_index = snapShot.val();\n          console.log(\"Key index is \" + key_index);\n\n          _this.setState({\n            keyIndex: key_index\n          });\n        });\n      }\n    };\n\n    _this.addTotalMoneyEarned = function (earned) {\n      console.log(\"Add Total Money Earned Called with earned = \" + earned);\n      var newTotal = _this.state.moneyEarned + earned;\n\n      _this.writeTotalMoneyEarned(newTotal);\n\n      console.log(\"Money Earned Updated\");\n    };\n\n    _this.writeGoalMoneyEarned = function (goalKey, earned) {\n      var user = firebase.auth().currentUser;\n\n      if (user) {\n        firebase.database().ref('users/' + user.uid + '/user_app_data/goals/' + goalKey).update({\n          earned: earned\n        });\n\n        _this.pullGoals(user);\n      }\n    };\n\n    _this.setGoalMoneyEarned = function (earned, oldTotal, key) {\n      var goals = _this.state.goals;\n\n      if (earned > _this.state.moneyEarned) {\n        Alert.alert(\"Not Enough Money\", \"You're too poor to add that amount... ðŸ˜¢\", [{\n          text: \"OK\",\n          onPress: function onPress() {\n            return console.log(\"OK Pressed\");\n          }\n        }], {\n          cancelable: false\n        });\n      } else {\n        console.log(\"Set Goal Money Used Called with earned = \" + earned);\n        console.log(\"old total was: \" + oldTotal);\n        var newTotal = Number(oldTotal) + Number(earned);\n\n        _this.writeGoalMoneyEarned(key, newTotal);\n\n        console.log(\"Goal updated with new total: \" + newTotal);\n\n        _this.addTotalMoneyEarned(-1 * earned);\n\n        console.log(\"Goal Money Used Updated for goal \" + key);\n      }\n\n      return goals;\n    };\n\n    _this.addGoal = function (goalName, moneyNeeded) {\n      if (isNaN(Number(moneyNeeded))) {\n        Alert.alert(\"Not a Number\", \"Please enter a valid number, you silly! ðŸ˜›\", [{\n          text: \"OK\",\n          onPress: function onPress() {\n            return console.log(\"OK Pressed\");\n          }\n        }], {\n          cancelable: false\n        });\n        return \"keepName\";\n      } else if (goalName == \"\") {\n        Alert.alert(\"Invalid Entry\", \"Your goal needs a name!\", [{\n          text: \"OK\",\n          onPress: function onPress() {\n            return console.log(\"OK Pressed\");\n          }\n        }], {\n          cancelable: false\n        });\n        return \"keepNumber\";\n      } else if (Number(moneyNeeded) <= 0) {\n        Alert.alert(\"Invalid Entry\", \"Any goal worth saving for will require an amount of money greater than 0!\", [{\n          text: \"OK\",\n          onPress: function onPress() {\n            return console.log(\"OK Pressed\");\n          }\n        }], {\n          cancelable: false\n        });\n        return \"keepName\";\n      } else {\n        _this.writeNewGoal(goalName, moneyNeeded);\n\n        _this.toggleGoalAdderVisible();\n\n        console.log(\"Goal Added\");\n        return \"removeBoth\";\n      }\n    };\n\n    _this.removeGoal = function (key) {\n      var user = firebase.auth().currentUser;\n\n      if (user) {\n        firebase.database().ref('users/' + user.uid + '/user_app_data/goals/' + key).remove();\n\n        _this.pullGoals(user);\n\n        console.log(\"Goal Removed\");\n      }\n    };\n\n    _this.toggleGoalAdderVisible = function () {\n      var flippedState = !_this.state.isGoalAdderVisible;\n\n      _this.setState({\n        isGoalAdderVisible: flippedState\n      });\n    };\n\n    _this.toggleGoogleInfoVisible = function () {\n      var flippedState = !_this.state.isGoogleInfoVisible;\n\n      _this.setState({\n        isGoogleInfoVisible: flippedState\n      });\n    };\n\n    _this.toggleMoneyLoggerVisible = function () {\n      var flippedState = !_this.state.isMoneyLoggerVisible;\n\n      _this.setState({\n        isMoneyLoggerVisible: flippedState\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(MainPage, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      console.log(\"Component mounted (it did)\");\n      var user = firebase.auth().currentUser;\n\n      if (user) {\n        firebase.database().ref('/users/' + user.uid + '/first_name').on('value', function (querySnapShot) {\n          var data = querySnapShot.val() ? querySnapShot.val() : {};\n          var name = data;\n\n          _this2.setState({\n            userName: name\n          });\n        });\n        firebase.database().ref('/users/' + user.uid + '/gmail').on('value', function (querySnapShot) {\n          var data = querySnapShot.val() ? querySnapShot.val() : {};\n          var gmail = data;\n\n          _this2.setState({\n            userEmail: gmail\n          });\n        });\n        firebase.database().ref('/users/' + user.uid + '/profile_picture').on('value', function (querySnapShot) {\n          var data = querySnapShot.val() ? querySnapShot.val() : {};\n          var profile_picture = data;\n          console.log(\"Profile picture url: \" + profile_picture);\n\n          _this2.setState({\n            profilePicUrl: profile_picture\n          });\n        });\n        this.pullMoneyEarned(user);\n        this.pullKeyIndex(user);\n        this.pullGoals(user);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      console.log(\"App rendered. Current goal list is: \" + this.state.goals);\n      console.log(\"Current money earned is: \" + this.state.moneyEarned);\n      return React.createElement(View, {\n        style: styles.container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 7\n        }\n      }, React.createElement(Spacer, {\n        numSpaces: \"7\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 9\n        }\n      }), React.createElement(View, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 9\n        }\n      }, React.createElement(Spacer, {\n        numSpaces: \"3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 11\n        }\n      }), React.createElement(View, {\n        style: {\n          flexDirection: 'row',\n          justifyContent: 'space-between',\n          width: 370\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 11\n        }\n      }, React.createElement(View, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 13\n        }\n      }, React.createElement(Image, {\n        source: require(\"../assets/newLogo.png\"),\n        style: styles.logoImage,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 15\n        }\n      })), React.createElement(View, {\n        style: {\n          flexDirection: 'row',\n          justifyContent: 'space-between',\n          width: 140\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 13\n        }\n      }, React.createElement(View, {\n        style: {\n          flexDirection: 'column',\n          justifyContent: 'center'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 15\n        }\n      }, React.createElement(Modal, {\n        isVisible: this.state.isGoogleInfoVisible,\n        onBackdropPress: function onBackdropPress() {\n          return _this3.toggleGoogleInfoVisible();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 17\n        }\n      }, React.createElement(Button, {\n        color: \"#234041\",\n        title: \"Sign Out\",\n        onPress: function onPress() {\n          return firebase.auth().signOut();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 19\n        }\n      }))), React.createElement(TouchableOpacity, {\n        style: {\n          flexDirection: 'column',\n          justifyContent: 'center'\n        },\n        onPress: this.toggleGoogleInfoVisible,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 15\n        }\n      }, React.createElement(View, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 17\n        }\n      }, React.createElement(Image, {\n        source: {\n          uri: this.state.profilePicUrl\n        },\n        style: styles.profileImage,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 19\n        }\n      })))))), React.createElement(View, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 9\n        }\n      }, React.createElement(Spacer, {\n        numSpaces: \"1\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 11\n        }\n      }), React.createElement(View, {\n        style: {\n          flexDirection: 'row',\n          justifyContent: 'space-evenly'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 11\n        }\n      }, React.createElement(View, {\n        style: {\n          flexDirection: 'row'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 13\n        }\n      }, React.createElement(View, {\n        style: {\n          width: 120,\n          height: 36\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 15\n        }\n      }, React.createElement(Button, {\n        color: \"#234041\",\n        onPress: this.toggleMoneyLoggerVisible,\n        title: \"Log Earnings\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 17\n        }\n      }))), React.createElement(View, {\n        style: {\n          flexDirection: 'row',\n          justifyContent: 'center'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 13\n        }\n      }, React.createElement(View, {\n        style: {\n          width: 120,\n          height: 36\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 345,\n          columnNumber: 15\n        }\n      }, React.createElement(Button, {\n        color: \"#234041\",\n        onPress: this.toggleGoalAdderVisible,\n        title: \"New Goal\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 346,\n          columnNumber: 17\n        }\n      })))), React.createElement(Modal, {\n        isVisible: this.state.isMoneyLoggerVisible,\n        onBackdropPress: function onBackdropPress() {\n          return _this3.toggleMoneyLoggerVisible();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 11\n        }\n      }, React.createElement(InterfaceFrame, {\n        returnMoneyEarned: this.addTotalMoneyEarned.bind(this),\n        toggleVisible: this.toggleMoneyLoggerVisible.bind(this),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 13\n        }\n      })), React.createElement(Modal, {\n        isVisible: this.state.isGoalAdderVisible,\n        onBackdropPress: function onBackdropPress() {\n          return _this3.toggleGoalAdderVisible();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 11\n        }\n      }, React.createElement(GoalAdder, {\n        addGoal: this.addGoal.bind(this),\n        toggleVisible: this.toggleGoalAdderVisible.bind(this),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 13\n        }\n      })), React.createElement(GoalWindow, {\n        goals: this.state.goals,\n        removeGoal: this.removeGoal,\n        totalMoneyEarned: this.state.moneyEarned,\n        setGoalMoneyEarned: this.setGoalMoneyEarned,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 11\n        }\n      }), React.createElement(Spacer, {\n        numSpaces: \"7\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 11\n        }\n      })));\n    }\n  }]);\n\n  return MainPage;\n}(Component);\n\nexport default MainPage;","map":{"version":3,"sources":["/Users/devonhubert/languages/javascript/react_native/PayCheck/screens/MainPage.js"],"names":["React","Component","firebase","Modal","InterfaceFrame","GoalAdder","Spacer","GoalWindow","styles","require","MainPage","state","goals","keyIndex","moneyEarned","isGoalAdderVisible","isGoogleInfoVisible","isMoneyLoggerVisible","userName","userEmail","profilePicUrl","pullMoneyEarned","user","console","log","database","ref","uid","on","snapShot","total_earned","val","setState","writeTotalMoneyEarned","totalEarned","auth","currentUser","update","pullGoals","Object","keys","length","writeNewGoal","goalName","moneyNeeded","name","needed","earned","key","key_index","pullKeyIndex","addTotalMoneyEarned","newTotal","writeGoalMoneyEarned","goalKey","setGoalMoneyEarned","oldTotal","Alert","alert","text","onPress","cancelable","Number","addGoal","isNaN","toggleGoalAdderVisible","removeGoal","remove","flippedState","toggleGoogleInfoVisible","toggleMoneyLoggerVisible","querySnapShot","data","gmail","profile_picture","container","flexDirection","justifyContent","width","logoImage","signOut","uri","profileImage","height","bind"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { \n  View, Alert, Image, Button, TouchableOpacity, Text\n} from 'react-native';\nimport firebase from 'firebase';\nimport Modal from 'react-native-modal';\n\nimport InterfaceFrame from '../components/InterfaceFrame';\nimport GoalAdder from '../components/GoalAdder';\nimport Spacer from '../components/Spacer';\nimport GoalWindow from '../components/GoalWindow';\n\nconst styles = require('../Styles');\n\n//Main App\nclass MainPage extends Component {\n\n  //Load and save goals from database later\n\n  state = {\n    goals: [],\n    keyIndex: 0,\n    moneyEarned: 0,\n    isGoalAdderVisible: false,\n    isGoogleInfoVisible: false,\n    isMoneyLoggerVisible: false,\n    userName: 'No Name',\n    userEmail: 'No Email',\n    profilePicUrl: '../assets/newLogo.png',\n  };\n\n  componentDidMount() {\n    console.log(\"Component mounted (it did)\");\n    var user = firebase.auth().currentUser;\n\n    if (user) {\n      firebase\n        .database()\n        .ref('/users/' + user.uid + '/first_name')\n        .on('value', querySnapShot => {\n          let data = querySnapShot.val() ? querySnapShot.val() : {};\n          let name = data;\n          this.setState({\n            userName: name,\n          });\n        });\n\n        firebase\n        .database()\n        .ref('/users/' + user.uid + '/gmail')\n        .on('value', querySnapShot => {\n          let data = querySnapShot.val() ? querySnapShot.val() : {};\n          let gmail = data;\n          this.setState({\n            userEmail: gmail,\n          });\n        });\n\n        firebase\n        .database()\n        .ref('/users/' + user.uid + '/profile_picture')\n        .on('value', querySnapShot => {\n          let data = querySnapShot.val() ? querySnapShot.val() : {};\n          let profile_picture = data;\n          console.log(\"Profile picture url: \" + profile_picture);\n          this.setState({\n            profilePicUrl: profile_picture,\n          });\n        });\n        \n        this.pullMoneyEarned(user);\n        this.pullKeyIndex(user);\n        this.pullGoals(user);\n    } \n  }\n\n  pullMoneyEarned = (user) => {\n    console.log(\"Pull money earned called\");\n    //user is not null\n    if(user) {\n      //pull total amount earned from database\n      firebase\n      .database()\n      .ref('/users/' + user.uid + '/user_app_data/total_earned/')\n      .on('value', snapShot => {\n        let total_earned = snapShot.val(); //check for 0?\n        console.log(\"Total earned is: \" + total_earned);\n        \n        this.setState({\n          moneyEarned: total_earned,\n        });\n      });\n    }\n  }\n\n  writeTotalMoneyEarned = (totalEarned) => {\n    var user = firebase.auth().currentUser;\n    if(user) {\n      firebase.database().ref('users/' + user.uid + '/user_app_data/').update({\n        total_earned: totalEarned,\n      });\n\n      //update state from database\n      this.pullMoneyEarned(user); //good?\n    }\n  }\n\n  pullGoals = (user) => {\n    console.log(\"Pull goals called\");\n    //user is not null\n    if(user) {\n      //pull goals earned from database\n      firebase\n      .database()\n      .ref('/users/' + user.uid + '/user_app_data/goals/')\n      .on('value', snapShot => {\n        let goals = snapShot.val() ? snapShot.val() : [];\n        console.log(\"Current goal object: \" + goals);\n        console.log(\"Length of goals: \" + Object.keys(goals).length);\n\n        this.setState({\n          goals: goals, \n        });\n        \n      });\n    } \n  }\n\n  writeNewGoal = (goalName, moneyNeeded) => {\n    var user = firebase.auth().currentUser;\n\n    if (user) {\n      firebase.database().ref('users/' + user.uid + '/user_app_data/goals/' + this.state.keyIndex).update({\n        name: goalName,\n        needed: moneyNeeded,\n        earned: 0.0,\n        key: this.state.keyIndex,\n      });\n      this.pullGoals(user);\n\n      //Increment key index in database, and pull to state\n      firebase.database().ref('users/' + user.uid + '/user_app_data/').update({\n        key_index: this.state.keyIndex + 1, \n      });\n      this.pullKeyIndex(user);\n    }\n  }\n\n  pullKeyIndex = (user) => {\n    console.log(\"Pull key index called\");\n    //user is not null\n    if(user) {\n      //pull keyIndex from database\n      firebase\n      .database()\n      .ref('/users/' + user.uid + '/user_app_data/key_index')\n      .on('value', snapShot => {\n        //let data = snapShot.val() ? snapShot.val() : {};\n        let key_index = snapShot.val();\n        console.log(\"Key index is \" + key_index);\n\n        this.setState({\n          keyIndex: key_index,\n        });\n        \n      });\n    }\n  }\n  \n  addTotalMoneyEarned = (earned) => {\n    console.log(\"Add Total Money Earned Called with earned = \" + earned);\n    let newTotal = this.state.moneyEarned + earned;\n    this.writeTotalMoneyEarned(newTotal); \n    console.log(\"Money Earned Updated\");\n  }\n\n  writeGoalMoneyEarned = (goalKey, earned) => {\n    var user = firebase.auth().currentUser;\n    if(user) {\n      firebase.database().ref('users/' + user.uid + '/user_app_data/goals/' + goalKey).update({\n        earned: earned,\n      });\n\n      //pull updated goals from database\n      this.pullGoals(user); \n    }\n  }\n\n  setGoalMoneyEarned = (earned, oldTotal, key) => {\n    let goals = this.state.goals;\n    \n    if(earned > this.state.moneyEarned) {\n      Alert.alert(\n        \"Not Enough Money\",\n        \"You're too poor to add that amount... ðŸ˜¢\",\n        [{text: \"OK\", onPress: () => console.log(\"OK Pressed\")}],\n        {cancelable: false}\n      );\n    } else {\n      console.log(\"Set Goal Money Used Called with earned = \" + earned);\n      console.log(\"old total was: \" + oldTotal);\n      let newTotal = Number(oldTotal) + Number(earned);\n    \n      this.writeGoalMoneyEarned(key, newTotal);\n      console.log(\"Goal updated with new total: \" + newTotal);\n      \n      this.addTotalMoneyEarned(-1 * earned);\n      console.log(\"Goal Money Used Updated for goal \" + key);\n    }\n    return goals;\n  }\n  \n  addGoal = (goalName, moneyNeeded) => {\n    if(isNaN(Number(moneyNeeded))) {\n      Alert.alert(\n        \"Not a Number\",\n        \"Please enter a valid number, you silly! ðŸ˜›\",\n        [{text: \"OK\", onPress: () => console.log(\"OK Pressed\")}],\n        {cancelable: false}\n      );\n      return \"keepName\";\n    } else if(goalName == \"\") {\n      //WHAT ABOUT IF BOTH HAVE AN ERROR?\n      Alert.alert(\n        \"Invalid Entry\",\n        \"Your goal needs a name!\",\n        [{text: \"OK\", onPress: () => console.log(\"OK Pressed\")}],\n        {cancelable: false}\n      );\n      return \"keepNumber\";\n    } else if(Number(moneyNeeded) <= 0) {\n      Alert.alert(\n        \"Invalid Entry\",\n        \"Any goal worth saving for will require an amount of money greater than 0!\",\n        [{text: \"OK\", onPress: () => console.log(\"OK Pressed\")}],\n        {cancelable: false}\n      );\n      return \"keepName\";\n    } else {\n      this.writeNewGoal(goalName, moneyNeeded);\n      this.toggleGoalAdderVisible();\n      console.log(\"Goal Added\");\n      return \"removeBoth\";\n    }\n  }\n\n  removeGoal = (key) => {\n    var user = firebase.auth().currentUser;\n\n    if(user) {\n      firebase.database().ref('users/' + user.uid + '/user_app_data/goals/' + key).remove();\n      \n      this.pullGoals(user);\n      console.log(\"Goal Removed\");\n    }\n  }\n\n  toggleGoalAdderVisible = () => {\n    let flippedState = !this.state.isGoalAdderVisible;\n    this.setState({\n      isGoalAdderVisible: flippedState,\n    });\n  }  \n\n  toggleGoogleInfoVisible = () => {\n    let flippedState = !this.state.isGoogleInfoVisible;\n    this.setState({\n      isGoogleInfoVisible: flippedState,\n    });\n  }  \n\n  toggleMoneyLoggerVisible = () => {\n    let flippedState = !this.state.isMoneyLoggerVisible;\n    this.setState({\n      isMoneyLoggerVisible: flippedState,\n    });\n  }  \n\n\n  render() {\n    \n    console.log(\"App rendered. Current goal list is: \" + this.state.goals);\n    console.log(\"Current money earned is: \" + this.state.moneyEarned);\n\n    return (\n      <View style={styles.container}>\n        <Spacer numSpaces='7' />\n        <View>      \n          <Spacer numSpaces='3' />\n          \n          <View style={{flexDirection:'row', justifyContent:'space-between', width:370}}>\n            <View>\n              <Image source={require('../assets/newLogo.png')} style={styles.logoImage} />\n            </View>\n            \n            <View style={{flexDirection:'row', justifyContent:'space-between', width:140}}>\n              \n              <View style={{flexDirection:'column', justifyContent: 'center'}}>\n                <Modal \n                  isVisible={this.state.isGoogleInfoVisible}\n                  onBackdropPress={() => this.toggleGoogleInfoVisible()}\n                >\n                  <Button \n                    color=\"#234041\"\n                    title='Sign Out'\n                    onPress={() => firebase.auth().signOut()}\n                  />\n                </Modal>\n              </View>\n              \n              <TouchableOpacity \n                style={{flexDirection:'column', justifyContent: 'center'}}\n                onPress={this.toggleGoogleInfoVisible}\n              >\n                <View>\n                  <Image source={{\n                    uri: this.state.profilePicUrl,\n                    }} \n                    style={styles.profileImage}\n                  />\n                </View>\n              </TouchableOpacity>\n\n            </View>\n          </View>\n        </View>\n\n        <View> \n          <Spacer numSpaces='1' />   \n\n          \n          \n          <View style={{flexDirection:'row', justifyContent:'space-evenly'}}>\n            <View style={{flexDirection:'row'}}>\n              <View style={{width:120, height:36}}>\n                <Button\n                  color=\"#234041\"\n                  onPress={this.toggleMoneyLoggerVisible}\n                  title=\"Log Earnings\"\n                />  \n              </View>\n            </View>\n\n            <View style={{flexDirection:'row', justifyContent:'center'}}>\n              <View style={{width:120, height:36}}>\n                <Button\n                  color=\"#234041\"\n                  onPress={this.toggleGoalAdderVisible}\n                  title=\"New Goal\"\n                />  \n              </View>\n            </View>\n          </View>\n\n          <Modal \n            isVisible={this.state.isMoneyLoggerVisible}\n            onBackdropPress={() => this.toggleMoneyLoggerVisible()}\n          >\n            <InterfaceFrame \n              returnMoneyEarned={this.addTotalMoneyEarned.bind(this)} \n              toggleVisible={this.toggleMoneyLoggerVisible.bind(this)}\n            />\n          </Modal>\n          \n          <Modal \n            isVisible={this.state.isGoalAdderVisible}\n            onBackdropPress={() => this.toggleGoalAdderVisible()}\n          >\n            <GoalAdder \n              addGoal={this.addGoal.bind(this)}\n              toggleVisible={this.toggleGoalAdderVisible.bind(this)} \n            />\n          </Modal>\n          \n          <GoalWindow \n            goals={this.state.goals} \n            removeGoal={this.removeGoal} \n            totalMoneyEarned={this.state.moneyEarned} \n            setGoalMoneyEarned={this.setGoalMoneyEarned}\n          />\n          <Spacer numSpaces='7' />\n        </View>\n        \n      </View>\n    );\n  }\n}\n\nexport default MainPage;\n\n"]},"metadata":{},"sourceType":"module"}